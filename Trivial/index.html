<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trivial Ferroviario de Alta Velocidad</title>
    
    <!-- ================================================================== -->
    <!-- =================== INICIO: CÓDIGO DE ICONOS =================== -->
    <!-- ================================================================== -->

    <!-- Favicon estándar para pestañas de navegador (versiones 32x32 y 16x16) -->
    <link rel="icon" type="image/png" sizes="32x32" href="icontrivial.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icontrivial.png">

    <!-- Icono para Apple (cuando se añade a la pantalla de inicio en iPhone/iPad) -->
    <link rel="apple-touch-icon" sizes="180x180" href="icontrivial.png">

    <!-- Icono de acceso directo (para máxima compatibilidad con navegadores antiguos) -->
    <link rel="shortcut icon" href="icontrivial.png">

    <!-- Enlace al Web App Manifest (mejora la experiencia de 'instalar' la web) -->
    <link rel="manifest" href="manifest.json">

    <!-- Meta-etiqueta para el color de la barra de estado en móviles -->
    <meta name="theme-color" content="#1a4488">

    <!-- ================================================================== -->
    <!-- ==================== FIN: CÓDIGO DE ICONOS ===================== -->
    <!-- ================================================================== -->

    <!-- Importar fuente Poppins de Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Importar Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Enlace a tu hoja de estilos externa -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="game-container">
        <!-- Pantalla de Inicio -->
        <div id="splash-screen" class="screen active">
            <h1>Trivial Ferroviario de Alta Velocidad</h1>
            <i class="fas fa-train splash-logo"></i>
            <div class="splash-buttons">
                <button id="start-game-btn" class="btn">Iniciar Juego</button>
                <button id="high-scores-btn" class="btn secondary-btn"><i class="fas fa-star"></i> Récords</button>
            </div>
        </div>
        
        <!-- Pantalla de Configuración de Jugadores -->
        <div id="player-config-screen" class="screen">
            <button class="close-btn" data-target-screen="splash-screen">×</button>
            <h2>Elige a los Jugadores</h2>
            <div id="player-cards-grid"></div>
            <div class="nav-buttons-container">
                <button id="start-match-btn" class="btn">Siguiente <i class="fas fa-arrow-right"></i></button>
            </div>
            <div class="legend-info">
                Al pulsar los <i class="fas fa-dice"></i> se elige nombre y avatar al azar
            </div>
        </div>

        <!-- Pantalla de Configuración de Categorías -->
        <div id="category-config-screen" class="screen">
            <button class="close-btn" data-target-screen="player-config-screen">×</button>
            <h2>Selecciona los Temas</h2>
            <div id="category-actions">
                 <button id="select-all-categories-btn" class="btn secondary-btn"><i class="fas fa-check-double"></i> Seleccionar/Deseleccionar Todos</button>
            </div>
            <div id="category-grid"></div>
            <div class="nav-buttons-container">
                <button id="back-to-players-btn" class="btn secondary-btn"><i class="fas fa-arrow-left"></i> Anterior</button>
                <button id="start-game-from-categories-btn" class="btn">Siguiente <i class="fas fa-arrow-right"></i></button>
            </div>
        </div>

        <!-- Pantalla de Configuración de Rondas -->
        <div id="round-config-screen" class="screen">
            <button class="close-btn" data-target-screen="category-config-screen">×</button>
            <div class="config-card">
                <h2>¿Cuántas preguntas por jugador?</h2>
                <div class="round-count-selector">
                    <button id="decrease-rounds-btn">-</button>
                    <span id="round-count">5</span>
                    <button id="increase-rounds-btn">+</button>
                </div>
                <div class="nav-buttons-container">
                    <button id="back-to-categories-btn" class="btn secondary-btn"><i class="fas fa-arrow-left"></i> Anterior</button>
                    <button id="start-game-from-rounds-btn" class="btn">¡A Jugar!</button>
                </div>
            </div>
        </div>
        
        <!-- Pantalla de Juego -->
        <div id="game-screen" class="screen">
            <div class="game-header">
                <div class="header-group player-info"> <!-- CAMBIO: Clase añadida para alinear -->
                    <div id="current-player-turn-display"></div>
                </div>
                
                <!-- CAMBIO INICIA: Estructura de comodines y clasificación simplificada -->
                <div class="header-group central-controls">
                    <div class="jokers-main-container">
                        <button id="toggle-jokers-btn" class="btn-icon-with-text">
                            <i class="fas fa-wand-magic-sparkles"></i>
                            <span class="btn-text">Comodines</span>
                        </button>
                        <div id="jokers-dropdown" class="jokers-dropdown-content">
                            <button id="pass-question-btn" class="joker-btn" title="Saltar la pregunta actual"><i class="fas fa-forward-step"></i><span class="joker-text">Pasar</span></button>
                            <button id="add-time-btn" class="joker-btn" title="Añade 5 segundos al temporizador"><i class="fas fa-hourglass-half"></i><span class="joker-text">+5s</span></button>
                            <button id="fifty-fifty-btn" class="joker-btn" title="Elimina 2 respuestas incorrectas"><i class="fas fa-divide"></i><span class="joker-text">50/50</span></button>
                        </div>
                    </div>
                    <button id="show-score-btn" class="btn-icon-with-text"><i class="fas fa-medal"></i><span class="btn-text">Clasificación</span></button>
                </div>
                <!-- CAMBIO TERMINA -->

                <div class="header-group exit-info"> <!-- CAMBIO: Clase añadida para alinear -->
                    <button id="exit-game-btn" class="fas fa-times btn-icon"></button>
                </div>
            </div>
            
            <div id="question-area">
                <div id="timer-wrapper">
                    <div id="timer-clock">
                        <span id="timer-text">10</span>
                    </div>
                    <div id="timer-container">
                        <div id="timer-bar"></div>
                    </div>
                </div>
                <div class="category-display"><i id="category-icon" class="fas fa-question-circle"></i><span id="category-name">Categoría</span></div>
                
                <div id="question-image-container" class="hidden">
                    <img id="question-image" src="" alt="Imagen de la pregunta">
                </div>

                <p id="question-text">Cargando pregunta...</p>
                <div id="options-grid" class="options-grid"></div>
                
                <div id="feedback-overlay">
                    <div id="feedback-card">
                        <button id="close-feedback-btn" class="close-btn">×</button>
                        <h4 id="feedback-title"></h4>
                        <p id="feedback-text-content"></p>
                    </div>
                </div>
            </div>

            <div class="game-progress-container">
                <span id="progress-text">Pregunta 1 de 10</span>
                <div class="progress-track-wrapper">
                    <i class="fas fa-house progress-icon"></i>
                    <div class="game-progress-bar-bg">
                        <div id="progress-stations-container"></div>
                        <i id="progress-train-icon" class="fas fa-train"></i>
                    </div>
                    <i class="fas fa-flag-checkered progress-icon"></i>
                </div>
            </div>
        </div>
        
        <!-- Pantalla de Fin de Partida -->
        <div id="end-screen" class="screen">
            <button class="close-btn" data-target-screen="splash-screen">×</button>
            <div id="confetti-container"></div>
            <h2>¡HABÉIS LLEGADO A DESTINO!</h2>
            <div id="winner-announcement-card"></div>
            <div id="podium-container" class="podium-container"></div>
            <div id="other-scores-container" class="other-scores-list"></div>
            <button id="play-again-btn" class="btn">Volver a Jugar</button>
        </div>
        
        <!-- Modales -->
        <div id="score-modal" class="modal-overlay">
            <div class="modal-content">
                <button class="close-btn" data-target-screen="hide-modal">×</button>
                <h3><i class="fas fa-trophy"></i> Clasificación Actual</h3>
                <ul id="modal-score-list"></ul>
            </div>
        </div>

        <div id="high-scores-modal" class="modal-overlay">
            <div class="modal-content">
                <button class="close-btn" data-target-screen="hide-high-scores-modal">×</button>
                <h3><i class="fas fa-star"></i> Récords Históricos</h3>
                <ol id="high-scores-list"></ol>
            </div>
        </div>
        
        <div id="confirm-exit-modal" class="modal-overlay">
            <div class="modal-content">
                <h3>¿Estás seguro que quieres salir?</h3>
                <p>Se perderá el progreso actual de la partida.</p>
                <div class="confirm-exit-buttons">
                    <button id="confirm-exit-yes" class="btn">Sí, salir</button>
                    <button id="confirm-exit-no" class="btn">No, continuar</button>
                </div>
            </div>
        </div>
        
        <div id="avatar-selection-modal" class="modal-overlay">
            <div class="modal-content">
                <button class="close-btn" data-target-screen="hide-avatar-modal">×</button>
                <h3>Personaliza tu Jugador</h3>
                <h4>Elige tu Avatar</h4>
                <div id="avatar-grid"></div>
                <h4>Elige tu Color</h4>
                <div id="color-palette"></div>
                <button id="save-avatar-btn" class="btn">Guardar</button>
            </div>
        </div>

        <div id="turn-transition-modal" class="modal-overlay">
            <div class="modal-content turn-transition-card">
                <h3>Turno de</h3>
                <div id="turn-player-display">
                    <div id="turn-player-avatar"></div>
                    <span id="turn-player-name"></span>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js" defer></script>
</body>
</html>